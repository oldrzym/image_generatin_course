

### Введение

В технологическом процессе разлива металлических цилиндров существует риск нарушения технологии, при котором стенки цилиндра не успевают застыть и трескаются. Это приводит к тому, что незастывший металл выливается из лунки, не образуя требуемую заготовку. Оперативное выявление лунок с проливами является важной задачей для предотвращения брака и повышения эффективности производства.

Целью данного проекта является разработка модели на основе автоэнкодера, способной автоматически определять состояние лунки: произошел пролив или нет. Проливы являются относительно редким явлением, поэтому в наличии имеется значительно больше изображений без проливов.

### Данные

Для реализации поставленной задачи были использованы следующие данные:

- **Обучающая выборка** (`dataset/train`): изображения лунок без проливов.
- **Выборка проливов** (`dataset/proliv`): изображения лунок с проливами, использованные для определения порогового значения MSE.
- **Тестовая выборка** (`dataset/test`): изображения, содержащие как проливы, так и нормальные лунки, а также файл с разметкой `test_annotation.txt`.

### Методология

1. **Выбор архитектуры модели**

   Для решения задачи был выбран автоэнкодер на основе архитектуры U-Net. Данная архитектура хорошо зарекомендовала себя в задачах сегментации и восстановления изображений благодаря своей симметричной структуре и наличию скип-коннекшенов, позволяющих передавать информацию между слоями энкодера и декодера.

2. **Обучение автоэнкодера**

   Модель обучалась на обучающей выборке, содержащей только изображения без проливов. В качестве функции потерь использовалась среднеквадратичная ошибка (MSE) между входным и восстановленным изображениями. Цель обучения заключалась в том, чтобы модель научилась эффективно восстанавливать нормальные лунки.
![image](https://github.com/user-attachments/assets/9939825f-b637-4415-99ad-f60db22fd8e8)
![image](https://github.com/user-attachments/assets/fcf140d1-80dc-4d7a-9e59-597f4fede638)

3. **Детекция аномалий**

   Предполагается, что автоэнкодер, обученный на нормальных данных, будет плохо восстанавливать аномальные изображения (с проливами), что приведет к увеличению MSE. Таким образом, сравнивая MSE восстановленных изображений с некоторым пороговым значением, можно классифицировать изображения на "пролив" и "нет пролива".

4. **Определение порогового значения**

   На выборке проливов были рассчитаны значения MSE, после чего было выбрано оптимальное пороговое значение, позволяющее эффективно разделять классы с минимальным количеством ошибок.

5. **Тестирование модели**

   Модель была протестирована на тестовой выборке. Для каждого изображения рассчитывалось MSE, и на основе порогового значения происходила классификация.

### Результаты

1. **Визуальный анализ восстановления**

   - **Нормальные лунки**: автоэнкодер успешно восстанавливает изображения без проливов, MSE остается низким.
   - **Лунки с проливами**: восстановление значительно хуже, MSE существенно выше порогового значения.



2. **Анализ ошибок восстановления**

   - Распределение MSE для нормальных лунок сосредоточено в области низких значений.
   - Распределение MSE для лунок с проливами смещено в область высоких значений.

   *График распределения MSE:*
![image](https://github.com/user-attachments/assets/b124d202-98c0-4839-bc68-c9933c0e78f0)


3. **Метрики качества**

   На основе классификации были рассчитаны следующие метрики:

   - **True Positive Rate (TPR)**: процент правильно выявленных проливов.
   - **True Negative Rate (TNR)**: процент правильно определенных нормальных лунок.

   *Таблица метрик:*

![image](https://github.com/user-attachments/assets/4d4c6cda-f328-484e-b9e7-4b056f31807e)

### Обсуждение результатов

Полученные результаты показывают, что использование автоэнкодера на основе U-Net эффективно для задачи детекции проливов в лунках:

- Высокие значения TPR и TNR свидетельствуют о том, что модель успешно различает проливы и нормальные лунки.
- Визуальный анализ подтверждает, что автоэнкодер плохо восстанавливает аномальные области, что приводит к увеличению MSE.
- Выбор оптимального порогового значения MSE является критичным для баланса между TPR и TNR.

**Ограничения и возможности улучшения:**

- **Несбалансированность данных**: из-за редкости проливов модель могла переобучиться на нормальные лунки. Добавление синтетических данных с проливами может улучшить обобщающую способность модели.
- **Шум и артефакты**: наличие шума в изображениях может влиять на MSE. Применение методов предобработки может повысить качество восстановления.
- **Альтернативные архитектуры**: исследование других архитектур автоэнкодеров или использование вариационных автоэнкодеров (VAE) может привести к улучшению результатов.

### Заключение

В рамках проекта была разработана модель на основе автоэнкодера U-Net для автоматического определения состояния лунки в процессе разлива металлических цилиндров. Модель продемонстрировала высокую эффективность в детекции проливов, что подтверждается метриками качества на тестовых данных.

Дальнейшие работы могут быть направлены на:

- Улучшение качества модели путем балансировки данных и увеличения разнообразия выборки.
- Исследование более сложных архитектур и методов для повышения точности детекции.
- Внедрение модели в реальный производственный процесс для оперативного контроля и предотвращения брака.

